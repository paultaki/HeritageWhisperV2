# **PRD: HeritageWhisper AI Intimacy Engine**

## **Transforming Generic Prompts into Proof of Deep Listening**

### **Executive Summary**

HeritageWhisper's current prompt system extracts meaningless entities ("Girl", "chair", "hospital room") and generates robotic questions nobody wants to answer. We're rebuilding it to create **artificial intimacy** \- making users feel genuinely heard by demonstrating granular attention to their stories through pattern recognition, emotional fingerprinting, and therapeutic-style follow-up questions.

**Core Insight:** Users don't need the AI to care about them. They need proof it was listening. That proof comes from the AI noticing patterns they don't see, remembering exact phrases, and asking about what they didn't say.

---

## **Project Goals**

### **Primary Objective**

Replace entity-based prompt generation with an emotional intelligence system that creates "holy shit, you really heard me" moments.

### **Success Metrics**

* **Prompt engagement rate:** \>40% (up from current \~25%)  
* **Story 3 to paid conversion:** \>45% (target from MVP doc)  
* **User retention:** Record 4+ stories/month (up from current 2-3)  
* **Prompt quality score:** 0% prompts about generic nouns (Girl, chair, room)

### **Anti-Goals**

* Do NOT ask about sensory details without emotional weight  
* Do NOT reference "your story" or use formal language  
* Do NOT generate therapy-speak ("How did that make you feel?")  
* Do NOT extract furniture, generic roles, or meaningless objects

---

## **Implementation Steps**

### **Step 1: Emotional Fingerprint Extraction**

**Replace entity extraction with pattern recognition**

#### **Requirements**

Build a new extraction system that identifies:

1. **Unique Phrases** (exact quotes 5-30 words)  
   * "housebroken by love"  
   * "brave and dependable"  
   * "never the same after that"  
2. **Turning Points**  
   * Words/phrases: decided, quit, left, chose, realized, discovered  
   * Temporal markers: "after that", "from then on", "never again"  
   * Life changes: "everything changed when", "that's when I knew"  
3. **Emotional Peaks**  
   * Intensity markers: never forget, still haunts, broke me, saved me  
   * Superlatives: hardest, proudest, worst, best  
   * Regret language: wish I had, should have, never got to  
4. **Relationship Dynamics**  
   * Power dynamics: disappointed, proud of me, looked up to  
   * Connection/disconnection: never understood, finally saw me, grew apart  
   * Teaching moments: taught me, learned from, showed me how  
5. **Values in Action**  
   * Choice points: had to choose, couldn't let, had to stand  
   * Sacrifice language: gave up, traded, lost, paid the price  
   * Principle language: believed in, fought for, stood by  
6. **Contradictions & Tensions**  
   * But/except/though/however statements  
   * Conflicting values or behaviors  
   * "Said X but did Y" patterns

#### **Implementation Notes**

* Extract phrases, not single words  
* Preserve exact wording for unique phrases (don't normalize)  
* Track which story each extraction came from  
* Store with confidence scores based on emotional weight

#### **Expected Output Structure**

typescript  
{  
  uniquePhrases: \[  
    { text: "housebroken by love", storyId: "xxx", context: "felt housebroken by love when" }  
  \],  
  turningPoints: \[  
    { phrase: "quit medical school", year: 1982, consequence: "disappointed father" }  
  \],  
  emotionalPeaks: \[  
    { intensity: "never forget", subject: "mother's funeral", emotion: "grief" }  
  \],  
  relationships: \[  
    { person: "father", dynamic: "disappointed", frequency: 2 }  
  \],  
  contradictions: \[  
    { stated: "didn't need anyone", lived: "spent every Sunday with father" }  
  \]

}

#### **Testing Criteria**

* Given story with "My father was brave and dependable", extracts exact phrase  
* Given "Girl said", returns empty (rejects generic nouns)  
* Given "decided to quit medical school", identifies as turning point  
* Extraction takes \<100ms per story

---

### **Step 2: Cross-Story Pattern Recognition**

**Build relationship map and thematic analysis across all user stories**

#### **Requirements**

1. **Person Tracking**  
   * Track every named person across all stories  
   * Note presence AND absence patterns  
   * Calculate "emotional weight" (how often \+ how intensely mentioned)  
   * Flag conspicuous absences (mom mentioned 5x, dad never)  
2. **Thematic Clustering**  
   * Group similar emotional moments across time  
   * Identify recurring patterns (always sacrifices for family)  
   * Track evolution (confident at 20, insecure at 40\)  
   * Find life threads (responsibility theme from dog → kids → parents)  
3. **Timeline Gaps**  
   * Identify missing decades or life phases  
   * Note avoided topics (5 career stories, 0 marriage stories)  
   * Track what stops being mentioned (brother disappears after story 3\)  
4. **Invisible Rules Detection**  
   * Pattern: Similar response to different situations  
   * Extract implied beliefs from repeated behaviors  
   * "Never asks for help" (seen across 3 stories)

#### **Implementation Notes**

* Run after each new story save  
* Update character\_evolution table with findings  
* Keep computational complexity O(n) where n \= story count  
* Cache results to avoid reprocessing

#### **Expected Output Structure**

typescript  
{  
  people: {  
    "father": { count: 3, lastMention: "story-3", emotionalWeight: 0.8, dynamics: \["disappointed", "proud"\] },  
    "mother": { count: 5, lastMention: "story-5", emotionalWeight: 0.9, dynamics: \["supportive"\] }  
  },  
  gaps: {  
    missing\_people: \["spouse \- conspicuously absent"\],  
    missing\_periods: \["ages 25-35"\],  
    avoided\_topics: \["romantic relationships"\]  
  },  
  patterns: {  
    recurring: \["sacrifices for others", "avoids conflict"\],  
    evolution: \["confident youth" → "cautious adult"\],  
    invisible\_rules: \["Never show weakness", "Family before self"\]  
  }

}

#### **Testing Criteria**

* Correctly identifies when same person appears in multiple stories  
* Detects when someone stops being mentioned  
* Finds patterns across 3+ stories with 90% accuracy  
* Processing 50 stories takes \<500ms

---

### **Step 3: Intimate Prompt Generation**

**Create prompts that prove deep listening**

#### **Requirements**

Generate 4 types of prompts based on extraction and patterns:

1. **"I Caught That" Prompts** (30% of total)  
   * Use exact unique phrases  
   * Ask for deeper meaning  
   * Format: "You said '\[exact phrase\].' \[specific follow-up about meaning\]"  
   * Example: "You felt 'housebroken by love.' What freedom did you trade for that feeling?"  
2. **"I See Your Pattern" Prompts** (25% of total)  
   * Reference behavior across multiple stories  
   * Name the pattern explicitly  
   * Format: "\[Pattern observation\]. \[Question about origin/meaning\]"  
   * Example: "You sacrifice for family in every story. Where did you learn that's what love looks like?"  
3. **"I Notice the Absence" Prompts** (25% of total)  
   * Ask about who/what is missing  
   * Gentle but direct  
   * Format: "\[Present observation\] but \[absence\]. \[Curious question\]"  
   * Example: "You mention Mom's strength five times but never mention Dad. What's his story?"  
4. **"I Understand the Cost" Prompts** (20% of total)  
   * Acknowledge tradeoffs  
   * Validate difficult choices  
   * Format: "You got \[achievement\] but \[implied loss\]. \[Question about worth/impact\]"  
   * Example: "You got the promotion but missed your daughter's childhood. When did you realize the price?"

#### **Prompt Construction Rules**

* MAX 30 words (hard limit)  
* Must reference specific details from their stories  
* No story titles or formal language ("In your story about...")  
* Conversational tone \- like a friend who was really listening  
* No therapy-speak or psychology jargon  
* End with open question that invites storytelling, not yes/no

#### **Priority Algorithm**

1. Tier 3 (milestone patterns) \> Tier 1 (recent story) \> Echo  
2. Within tier, prioritize by emotional weight score  
3. Never show 2 similar prompts in sequence  
4. Retire after 3 skips

#### **Expected Output Structure**

typescript  
{  
  prompt\_text: "You felt 'housebroken by love.' What freedom did you trade for that feeling?",  
  type: "caught\_that",  
  confidence: 0.85,  
  anchor\_phrase: "housebroken by love",  
  source\_stories: \["story-1"\],  
  emotional\_weight: 0.9,  
  word\_count: 14

}

#### **Testing Criteria**

* All prompts ≤30 words  
* Uses exact phrases from stories (not paraphrased)  
* No prompts contain "Girl", "Man", "Room" or other generic nouns  
* 0% contain "your story" or "you mentioned in"  
* Feel conversational when read aloud

---

### **Step 4: Quality Gates & Validation**

**Prevent bad prompts from reaching users**

#### **Requirements**

1. **Pre-Storage Validation**  
   * Reject prompts with generic entities (Girl, Boy, Man, Woman, House, Room)  
   * Reject therapy-speak ("How did that make you feel", "Tell me more")  
   * Reject yes/no questions  
   * Reject prompts \>30 words  
   * Reject prompts without specific story references  
2. **Scoring Algorithm**

  Base: 50 points  
   \+ 20 if uses exact unique phrase  
   \+ 15 if connects multiple stories    
   \+ 15 if asks about absence/gap  
   \+ 10 if acknowledges contradiction  
   \- 30 if contains generic noun  
   \- 20 if uses formal language

   \- 20 if asks about sensory details without emotional context

3. **A/B Testing Framework**  
   * Track engagement rate by prompt type  
   * Track skip rate by template  
   * Identify which patterns drive recording  
   * Auto-retire templates with \>60% skip rate

#### **Implementation Notes**

* Run validation before database insertion  
* Log rejected prompts for analysis  
* Track scores in prompt\_history for optimization

#### **Testing Criteria**

* Rejects "What's the clearest memory you have of Girl?"  
* Accepts "You felt 'housebroken by love.' What freedom did you trade?"  
* Validation runs in \<10ms  
* Catches 100% of generic noun prompts

---

### **Step 5: Update Existing Prompts**

**Migrate current active\_prompts to new system**

#### **Requirements**

1. Scan all active\_prompts for quality  
2. Delete any with generic entities  
3. Regenerate using new extraction system  
4. Preserve prompt history for analytics

#### **Migration Steps**

1. Backup current active\_prompts table  
2. Run quality validation on all active prompts  
3. Flag low-quality for deletion  
4. For each user with deleted prompts:  
   * Re-run emotional extraction on their stories  
   * Generate new prompts using intimate prompt system  
5. Update prompt\_score with new scoring algorithm

---

## 

# **PRD Addition: Conversational Greetings & Timeline Presence**

## **Step 6: Dynamic Greeting System**

**Create time-aware, personalized entry points that acknowledge the user's journey**

### **Requirements**

Build a greeting system that makes users feel welcomed back, not just prompted to record. The greeting should appear at the top of the timeline as the first card when they open the app.

#### **Greeting Components**

1. **Time-Aware Salutation**  
   * Morning (5am-12pm): "Good morning, \[Name\]"  
   * Afternoon (12pm-5pm): "Good afternoon, \[Name\]"  
   * Evening (5pm-9pm): "Good evening, \[Name\]"  
   * Night (9pm-5am): "Hi \[Name\]" (softer, respectful of late hours)  
2. **Continuation Acknowledgment** (one of these based on context)  
   * First visit: "Ready to share your first story?"  
   * Returning same day: "Back to share more? I'm listening."  
   * Next day: "Good to see you again."  
   * After 3+ days: "I've been thinking about your story about \[last topic\]."  
   * After 1 week+: "Your stories about \[theme\] really stuck with me."  
3. **Gentle Nudge Options** (rotate these, don't repeat)  
   * Pattern-based: "I noticed you haven't shared about \[detected gap\] yet."  
   * Continuation: "Want to tell me what happened after \[last story ending\]?"  
   * Depth: "Ready to go deeper on \[emotional moment from last story\]?"  
   * Choice: "I have 3 questions based on your \[father/mother/theme\] stories. Want to see them?"  
   * Open: "What's on your mind today?"

#### **Greeting Formula**

\[Time Salutation\], \[Name\]. \[Continuation\]. \[Nudge/Question\]

#### **Examples**

**First Timer:** "Good morning, Sarah. Ready to share your first story? I'll start with something easy."

**Regular User (same day):** "Welcome back, John. That story about Chewy was powerful. Want to tell me what happened next?"

**Returning After Break:** "Good evening, Mary. I've been thinking about your father's workshop stories. Ready to share more?"

**Power User (10+ stories):** "Hi David. Your pattern of choosing duty over desire fascinates me. When did that start?"

**After Emotional Story:** "Good morning, Lisa. Thank you for trusting me with yesterday's story. Take your time today \- I'm here when you're ready."

### **Implementation Details**

#### **Context Variables to Track**

typescript  
{  
  lastVisit: timestamp,  
  lastStoryTopic: string,  
  lastStoryEmotion: string,  
  storyCount: number,  
  dominantTheme: string,  
  lastPromptShown: string,  
  sessionsToday: number,  
  avgSessionTime: number,  
  lastStoryWasHeavy: boolean *// for sensitive follow-ups*

}

#### **Greeting Selection Logic**

1. Check time of day for salutation  
2. Calculate time since last visit  
3. Assess emotional weight of last story  
4. Pick appropriate continuation phrase  
5. Select nudge based on:  
   * If returning same day: Reference last story  
   * If new day: Broader theme reference  
   * If been away: Welcoming back  
   * If heavy last story: Gentler approach

#### **Special Cases**

**After They Skip a Prompt 3x:** "Hi \[Name\]. Those prompts didn't resonate? Let me try a different approach..."

**After Recording from Prompt:** "Good morning, \[Name\]. Your answer about \[topic\] was beautiful. Ready for the next question?"

**After Marking "Do Not Ask":** "Hi \[Name\]. I'll avoid that topic. What would you like to share instead?"

**Milestone Moments:**

* Story 3: "Three stories in, \[Name\]. You're building something special here."  
* Story 10: "Ten stories\! Your family will treasure these, \[Name\]."  
* Story 25: "Twenty-five memories preserved. You're creating a real legacy, \[Name\]."

### **Technical Requirements**

#### **Storage**

Add to user context or cache:

* Last greeting shown (prevent repeats)  
* Greeting engagement (did they record after seeing it?)  
* Time zone (for accurate time-of-day)

#### **Rotation Logic**

* Never show same nudge twice in a row  
* Track last 5 greetings to ensure variety  
* If user ignores greeting 3x, switch to simpler format

#### **Fallback Greetings**

If context loading fails:

* "Hi \[Name\]. What story wants to be told today?"  
* "Good to see you, \[Name\]. Ready to record?"  
* "\[Time greeting\], \[Name\]. I'm listening."

### **Display Specifications**

#### **Visual Design**

* Card appears at top of timeline  
* Slightly different styling (softer edges, warmer color)  
* Dismissible but returns next session  
* No "robot" feeling \- like a friend's text message

#### **Typography**

* Greeting in conversational font  
* Name in slight emphasis (not bold, maybe medium weight)  
* Question in regular weight  
* Total length: 2-3 lines max on mobile

### **Testing Criteria**

1. **Variety Check**  
   * User sees different greeting each visit for 7 days  
   * No repeated nudges within 5 sessions  
2. **Context Accuracy**  
   * Correctly identifies time of day  
   * References actual stories (not hallucinated)  
   * Respects "do not ask" topics  
3. **Engagement Impact**  
   * Track: % who record after seeing greeting vs without  
   * Target: 10% lift in session-to-recording conversion  
4. **Tone Validation**  
   * Beta users feel "welcomed" not "nagged"  
   * Heavy story \= gentler follow-up  
   * Celebration at milestones feels genuine

### **Example Greeting Progression (One User's Week)**

**Day 1, Morning (First visit):** "Good morning, Robert. Ready to share your first story? Let's start with something you're proud of."

**Day 1, Evening (Recorded 1 story about father):** "Welcome back, Robert. Your father sounds remarkable. What else do you remember about him?"

**Day 2, Afternoon:** "Good afternoon, Robert. Yesterday's story about your father's workshop was moving. Who else spent time there?"

**Day 4 (Been away):** "Hi Robert. I've been thinking about your father's workshop story. When did you realize you'd never be the craftsman he was?"

**Day 7 (After 3 stories):** "Good morning, Robert. Three beautiful stories so far. Your theme of 'living up to expectations' runs deep. Want to explore that?"

### **Why This Matters**

This greeting system serves three purposes:

1. **Reduces cold start friction** \- Easier to engage with a warm greeting  
2. **Proves persistent attention** \- "I remember you and your stories"  
3. **Creates ritual** \- Daily check-in feels like visiting a friend

The greeting becomes part of the value prop: "The AI that remembers me and actually cares about my story continuing."

## **Testing & Validation**

### **Test Scenarios**

#### **Scenario 1: Single Story Processing**

**Input:** First story about getting dog Chewy and becoming parent **Expected:**

* Extracts "housebroken by love" as unique phrase  
* Identifies "responsibility" theme  
* Generates prompt using exact phrase  
* Does NOT extract "dog" as generic entity

#### **Scenario 2: Pattern Detection Across Stories**

**Input:** 3 stories mentioning father's disappointment **Expected:**

* Identifies "disappointment" pattern  
* Generates pattern prompt: "Your father's disappointment appears three times. When did you stop trying to impress him?"  
* Stores pattern in character\_evolution

#### **Scenario 3: Absence Detection**

**Input:** 5 stories about family, none mention spouse **Expected:**

* Flags "spouse" as conspicuous absence  
* Generates absence prompt (after story 5\)  
* Respects if user marks as "do not ask"

### **Quality Metrics to Track**

* % prompts using exact user phrases (target: \>60%)  
* % prompts rejected by quality gate (should decrease over time)  
* Average prompt engagement rate by type  
* User sentiment: "This thing really gets me" moments

### **Rollout Plan**

1. Test with 10 beta users first  
2. A/B test: 50% get new system, 50% keep old  
3. Monitor engagement metrics for 2 weeks  
4. Full rollout if engagement improves \>15%

---

## **Non-Functional Requirements**

### **Performance**

* Extraction: \<100ms per story  
* Pattern recognition: \<500ms for 50 stories  
* Prompt generation: \<200ms per prompt  
* Quality validation: \<10ms per prompt

### **Scalability**

* Support 10,000 concurrent users  
* Process 100,000 stories/day  
* Store 1M prompts in active\_prompts table

### **Reliability**

* Graceful fallback if OpenAI fails  
* Never show empty prompt screen (use fallbacks)  
* Validate before storage (no bad prompts in DB)

---

## **Dependencies & Risks**

### **Dependencies**

* OpenAI GPT-4o for Tier 3 analysis (already integrated)  
* Existing database schema (active\_prompts, prompt\_history)  
* User story data (minimum 1 story to generate prompts)

### **Risks**

1. **Over-personalization** \- Prompts too specific might feel creepy  
   * Mitigation: Test comfort level with beta users  
2. **Pattern false positives** \- Seeing patterns that aren't there  
   * Mitigation: Require 3+ instances before calling it a pattern  
3. **Emotional triggers** \- Asking about trauma/absence  
   * Mitigation: Respect do\_not\_ask, gentle language

---

## **Success Criteria**

### **Week 1 Post-Launch**

* 0 prompts about "Girl" or "chair" generated  
* 80% of prompts use specific story details

* Engagement rate improves \>10%

### **Month 1 Post-Launch**

* Story 3→Paid conversion hits 45% target  
* Users recording 4+ stories/month  
* "This AI really gets me" feedback in reviews

### **Key Quote to Remember**

**"The prompt isn't personalized because it mentions 'chair.' It's personalized because it recognizes they trade freedom for security every time they tell a story about love."**

---

*This addition integrates with the existing PRD as Step 6, creating a complete "intimate AI experience" from the moment users open the app.*

